plugins {
    id 'java'
}

group 'cyren'
version '1.0-RELEASE'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
    maven {
            name = "GitHubPackages"
            url = uri("https://oss.sonatype.org/")
            
        }
    }
}

dependencies {
    implementation 'io.micrometer:micrometer-registry-prometheus:latest.release'
    compileOnly group: 'com.github.tomakehurst', name: 'wiremock-jre8', version: "$WIREMOCK_VERSION"

    testImplementation group: 'com.github.tomakehurst', name: 'wiremock-jre8', version: "$MICROMETER_VERSION"
    testImplementation group: 'junit', name: 'junit', version: "$JUNIT_VERSION"
}

task fatJar(type: Jar) {
  archiveBaseName = 'wire-mock-extensions'
  from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
  with jar
}

tasks.register('uberJar', Jar) {
    archiveClassifier = 'uber'

    from sourceSets.main.output

    dependsOn configurations.runtimeClasspath
    from {
        configurations.runtimeClasspath.findAll { it.name.endsWith('jar') }.collect { zipTree(it) }
    }
}
